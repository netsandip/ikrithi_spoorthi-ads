<div class="row">    <div class="col-lg-12">        <h1 class="page-header">Advertisement Release Order</h1>        <a href="<?php echo base_url() . "release_order/"; ?>" class="btn btn-primary pull-right btn-top-right">View</a>    </div><!-- /.col-lg-12 --></div><!-- /.row --><div class="row">    <div class="col-lg-12">        <?php if ($message != "") { ?>            <?php echo $message; ?>        <?php } ?>        <div class="row">            <div class="col-md-12">                <?php echo form_open($action); ?>                <div class="row">                    <div class="col-md-6">                        <div class="form-group">                            <?php echo form_label("To"); ?>                            <?php echo form_dropdown('vendor', $dropdown_vendor['options'], $dropdown_vendor['default'], array('class' => 'form-control', 'id' => 'vendor', 'onchange' => 'checkCommission(this);loadPublications(this,\'.publications\');loadCoordinators(this);resetEditions();')); ?>                        </div>                        <div class="form-group">                            <?php echo form_label("Select Coordinator"); ?>                            <?php echo form_dropdown('coordinator', '', '', array('class' => 'form-control', 'id' => 'coordinators')); ?>                        </div>                    </div>                    <div class="col-md-6">                        <table class="table table-bordered table-condensed">                            <thead>                                <tr>                                    <th class="text-center info">RO No.</th>                                    <th class="text-center">-- auto generated --</th>                                    <th class="text-center info">DATE</th>                                    <th class="text-center"><?php echo date('d-M-y', time()); ?></th>                                </tr>                            </thead>                        </table>                        <div class="form-group">                            <?php echo form_dropdown('client', $dropdown_client['options'], $dropdown_client['default'], array('class' => 'form-control')); ?>                        </div>                        <div class="form-group">                            <?php echo form_label('Enter Caption'); ?>                            <?php echo form_input($input_caption, '', array('class' => 'form-control')); ?>                        </div>                        <div class="form-group">                            <?php echo $dropdown_ad_type; ?>                            <?php // echo form_dropdown('ad_type', $dropdown_ad_type['options'], $dropdown_ad_type['default'], array('class' => 'form-control')); ?>                        </div>                        <div class="form-group">                            <select name="package" id="package" class="form-control">                                <option value="">Select Package</option>                            </select>                        </div>                    </div>                </div>                <table class="table table-bordered table-condensed table-hover">                    <colgroup>                        <col style="width: 24%" />                        <col style="width: 15%" />                        <col style="width: 10%" />                        <col style="width: 10%" />                        <col style="width: 10%" />                        <!--<col style="width: 9%" />-->                        <col style="width: 5%" />                        <col style="width: 5%" />                        <col style="width: 1%" />                    </colgroup>                    <thead>                        <tr class="info">                            <th><strong>Publication Name</strong></th>                            <th><strong>Insertion Date</strong></th>                            <th><strong>Edition</strong></th>                            <th><strong>Page</strong></th>                            <th class="text-center"><strong>Size <span id="ad_type_size_label"></span></strong></th>                            <!--<th class="text-center"><strong>Package</strong></th>-->                            <th><strong>Base Rate</strong></th>                            <th class="text-right"><strong>Total</strong></th>                            <th></th>                        </tr>                    </thead>                    <tbody id="order_content">                        <tr>                            <td>                                <?php // echo form_dropdown('publication', $dropdown_publication['options'], $dropdown_publication['default'], array('class' => 'form-control publications', 'onchange' => 'loadEditions(this,\'edition1\')')); ?>                                <?php // <select name="publication[]" onchange="loadEditions(this, 'edition1');loadPackages(this, 'package1')" class="form-control publications"> ?>                                <select name="publication[]" onchange="loadEditions(this, 'edition1');" class="form-control publications">                                    <option value="">Select Publication</option>                                </select>                            </td>                            <td>                                <div class="input-group">                                    <input name="insertion_date[]" class="form-control ro_form_insertion_date" type="text" />                                    <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>                                </div>                            </td>                            <td>                                <select name="edition[]" id="edition1" class="form-control editions">                                    <option value="">Select Edition</option>                                </select>                            </td>                            <td>                                <?php echo form_dropdown('page_type[]', $dropdown_page_type['options'], $dropdown_page_type['default'], array('class' => 'form-control')); ?>                            </td>                            <td class="ad_type_size">                                <!--                                <div class="row">                                                                                                    <div class=" col-md-6" style="padding-right: 3px;">                                                                                                        <input name="size_width[]" class="form-control" />                                                                                                    </div>                                                                                                    <div class=" col-md-6" style="padding-left: 3px;">                                                                                                        <input name="size_height[]" class="form-control" />                                                                                                    </div>                                                                                                </div>-->                            </td><!--                            <td>                                <select name="package[]" id="package1" class="form-control packages">                                    <option value="">Select Package</option>                                </select>                            </td>-->                            <td>                                <input id="base_rate1" name="base_rate[]" class="form-control small" onkeyup="computeRowTotal(1)" />                            </td>                            <td id="row_total1" class="text-right row_totals">                            </td>                            <td class="remove_order_item_container">                                <a onclick="removeOrderItem(this)" class="btn btn-danger"><i class="glyphicon glyphicon-remove"></i></a>                            </td>                        </tr>                    </tbody>                    <tfoot>                        <tr id="gross_amount_container">                            <td colspan="6" class="text-right">                                Gross Total                            </td>                            <td class="text-right" colspan="1" id="gross_amount"></td>                            <td colspan="1"></td>                        </tr>                        <tr>                            <td colspan="6" class="text-right">                                <div class="row">                                    <div class="col-md-3 pull-right">                                        <?php echo $dropdown_tax_items; ?>                                    </div>                                </div>                            </td>                            <td class="text-right" colspan="1" id="tax_amount"></td>                            <td></td>                        </tr>                        <tr>                            <td colspan="6" class="text-right">Total Amount</td>                            <td class="text-right info" colspan="1" id="total_amount"></td>                            <td></td>                        </tr>                        <tr>                            <td colspan="8">                                <a class="btn btn-success pull-right" onclick="addOrderItem()">Add +</a>                            </td>                        </tr>                    </tfoot>                </table>                <div class="row">                    <div class="col-md-3">                        <div class="form-group">                            <?php echo form_dropdown('material_type', $dropdown_material_type['options'], $dropdown_material_type['default'], array('class' => 'form-control')); ?>                        </div>                        <div class="form-group">                            <?php echo form_label('Material Status'); ?>                            <?php // echo form_input($input_material_status, '', array('class' => 'form-control')); ?>                            <?php echo form_dropdown('material_status', $dropdown_material_status['options'], $dropdown_material_status['default'], array('class' => 'form-control')); ?>                        </div>                    </div>                </div>                <div class="form-group">                    <?php echo form_reset('btn_reset', 'Clear', array('class' => 'btn btn-default')); ?>                    &nbsp;                    <?php echo form_submit('btn_submit', 'Save', array('class' => 'btn btn-primary')); ?>                </div>                <?php echo form_close(); ?>            </div><!-- /.col-md-6 -->        </div><!-- /.row -->    </div><!-- /.col-lg-12 --></div><!-- /.row --><script type="text/javascript">    var index = 2;    function addOrderItem() {        var ad_type = document.getElementById('ad_type');        var ad_type_size = ad_type.options[ad_type.options.selectedIndex].getAttribute('data-size');        var element = document.getElementById('order_content');        var table_row = document.createElement('tr');        var row_release_order_item = '<td>';//        row_release_order_item += '<?php // echo form_dropdown('publication', $dropdown_publication['options'], $dropdown_publication['default'], array('class' => 'form-control'));             ?>';//        row_release_order_item += '<select id="publication' + index + '" name="publication[]" onchange="loadEditions(this,\'edition' + index + '\');loadPackages(this, \'package' + index + '\')" class="form-control publications">';        row_release_order_item += '<select id="publication' + index + '" name="publication[]" onchange="loadEditions(this,\'edition' + index + '\');" class="form-control publications">';        row_release_order_item += '<option value="">Select Publication</option>';        row_release_order_item += '</select>';        row_release_order_item += '</td>';        row_release_order_item += '<td>';        row_release_order_item += '<div class="input-group">';        row_release_order_item += '<input name="insertion_date[]" class="form-control ro_form_insertion_date" type="text" />';        row_release_order_item += '<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>';        row_release_order_item += '</div>';        row_release_order_item += '</td>';        row_release_order_item += '<td>';        row_release_order_item += '<select name="edition[]" id="edition' + index + '" class="form-control editions">';        row_release_order_item += '<option value="">Select Edition</option>';        row_release_order_item += '</select>';        row_release_order_item += '</td>';        row_release_order_item += '<td>';        row_release_order_item += '<?php echo form_dropdown('page_type[]', $dropdown_page_type['options'], $dropdown_page_type['default'], array('class' => 'form-control')); ?>';        row_release_order_item += '</td>';        if (ad_type_size == "width_height") {            row_release_order_item += '<td class="ad_type_size">';            row_release_order_item += '<div class="row">';            row_release_order_item += '<div class=" col-md-6" style="padding-right: 3px;">';            row_release_order_item += '<input onkeyup="computeRowTotal(' + index + ')" name="size_width[]" class="form-control row_size' + index + '" />';            row_release_order_item += '</div>';            row_release_order_item += '<div class=" col-md-6" style="padding-left: 3px;">';            row_release_order_item += '<input onkeyup="computeRowTotal(' + index + ')" name="size_height[]" class="form-control row_size' + index + '" />';            row_release_order_item += '</div>';            row_release_order_item += '</div>';            row_release_order_item += '</td>';        } else {            row_release_order_item += '<td class="ad_type_size">';            row_release_order_item += '<input onkeyup="computeRowTotal(' + index + ')" name="size[]" class="form-control row_size' + index + '" />';            row_release_order_item += '</td>';        }//        row_release_order_item += '<td>';//        row_release_order_item += '<select name="package[]" id="package' + index + '" class="form-control packages">';//        row_release_order_item += '<option value="">Select Package</option>';//        row_release_order_item += '</select>';//        row_release_order_item += '</td>';        row_release_order_item += '<td>';        row_release_order_item += '<input id="base_rate' + index + '" onkeyup="computeRowTotal(' + index + ')" name="base_rate[]" class="form-control small" />';        row_release_order_item += '</td>';        // Display Total        row_release_order_item += '<td id="row_total' + index + '" class="text-right row_totals">';        row_release_order_item += '</td>';        row_release_order_item += '<td class="remove_order_item_container">';        row_release_order_item += '<a onclick="removeOrderItem(this)" class="btn btn-danger"><i class="glyphicon glyphicon-remove"></i></a>';        row_release_order_item += '</td>';        table_row.innerHTML = row_release_order_item;        element.appendChild(table_row);        // Fetch and populate publications dropdown        loadPublications(document.getElementById('vendor'), '#publication' + index);        index++;    }    function removeOrderItem(obj) {        var order_items = document.getElementsByClassName('remove_order_item_container');        if (order_items.length === 1) {            return false;        }        var row_tr = obj.parentNode.parentNode;        row_tr.parentNode.removeChild(row_tr);    }    function setSize() {        var ad_type = document.getElementById('ad_type');        var ad_type_size = ad_type.options[ad_type.options.selectedIndex].getAttribute('data-size');        var html = "";        if (ad_type_size == "width_height") {            document.getElementById('ad_type_size_label').innerHTML = "( W x H )";            html += '<td class="ad_type_size">';            html += '<div class="row">';            html += '<div class=" col-md-6" style="padding-right: 3px;">';//            html += '<input name="size_width[]" class="form-control" />';            html += '<input onkeyup="computeRowTotal(1)" name="size_width[]" class="form-control row_size1" />';            html += '</div>';            html += '<div class=" col-md-6" style="padding-left: 3px;">';//            html += '<input name="size_height[]" class="form-control" />';            html += '<input onkeyup="computeRowTotal(1)" name="size_height[]" class="form-control row_size1" />';            html += '</div>';            html += '</div>';            html += '</td>';        } else {            if (ad_type_size == "word") {                document.getElementById('ad_type_size_label').innerHTML = "( Words )";            } else if (ad_type_size == "linage") {                document.getElementById('ad_type_size_label').innerHTML = "( Lines )";            }            html += '<td class="ad_type_size">';//            html += '<input name="size[]" class="form-control" />';            html += '<input onkeyup="computeRowTotal(1)" name="size[]" class="form-control row_size1" />';            html += '</td>';        }        var td_size = document.getElementsByClassName('ad_type_size');        console.log(td_size);        for (var i in td_size) {            td_size[i].innerHTML = html;        }    }    function computeRowTotal(row_index) {                var size = 1;        var base_rate;        var row_total;        size_inputs = document.getElementsByClassName('row_size' + row_index);                if(size_inputs.length === 0){ return false; }        Array.prototype.forEach.call(size_inputs, function (size_input) {            size *= parseFloat(size_input.value);//            console.log(size_input);        });//            console.log(size_inputs);//        for(var i in size_inputs) {//            console.log(typeof i);//        }        base_rate = document.getElementById('base_rate' + row_index).value;                row_total = parseFloat(size) * parseFloat(base_rate);                if (isNaN(row_total)) {            return false;        }        document.getElementById('row_total' + row_index).innerHTML = row_total.toFixed(2);        computeGrossTotal();    }    function computeGrossTotal() {        var row_totals;        var gross_total = 0;        row_totals = document.getElementsByClassName('row_totals');        Array.prototype.forEach.call(row_totals, function (row_total) {//            console.log(row_total.innerHTML);            gross_total += parseFloat(row_total.innerHTML);        });        document.getElementById('gross_amount').innerHTML = gross_total.toFixed(2);        computeCommission();        computeTax();        computeNetTotal();    }    function computeNetTotal() {        var gross_total;        var net_total;        var tax;        var commission = 0;        gross_total = document.getElementById('gross_amount').innerHTML;        tax = document.getElementById('tax_amount').innerHTML;        if (document.getElementById('commission_amount') !== null) {            commission = document.getElementById('commission_amount').innerHTML;        }        gross_total = isNaN(parseFloat(gross_total)) ? 0 : parseFloat(gross_total);        tax = isNaN(parseFloat(tax)) ? 0 : parseFloat(tax);        commission = isNaN(parseFloat(commission)) ? 0 : parseFloat(commission);        net_total = gross_total + tax - commission;        document.getElementById('total_amount').innerHTML = net_total.toFixed(2);    }    function computeTax() {        var tax_element = document.getElementById('tax');        var tax_type = tax_element.options[tax_element.options.selectedIndex].getAttribute('data-taxtype');        var tax_value = tax_element.options[tax_element.options.selectedIndex].getAttribute('data-taxvalue');        tax_value = parseFloat(tax_value);        var tax_amount = 0;        var gross_total = 0;        if(tax_type === null) {            return false;        }        gross_total = document.getElementById('gross_amount').innerHTML;        gross_total = isNaN(parseFloat(gross_total)) ? 0 : parseFloat(gross_total);        if (tax_type === 'percentage') {            tax_amount = (gross_total / 100) * tax_value;        } else {            tax_amount = tax_value;        }        document.getElementById('tax_amount').innerHTML = tax_amount.toFixed(2);        computeNetTotal();    }        function computeCommission() {        var commission_percentage = window.commission;        var gross_total = 0;        gross_total = document.getElementById('gross_amount').innerHTML;        gross_total = isNaN(parseFloat(gross_total)) ? 0 : parseFloat(gross_total);                if (commission_percentage > 0) {            commission_amount = (gross_total / 100) * commission_percentage;        } else {            commission_amount = 0;        }                if (document.getElementById('commission_amount') !== null) {            document.getElementById('commission_amount').innerHTML = commission_amount.toFixed(2);        }                computeNetTotal();    }    computeNetTotal();</script>